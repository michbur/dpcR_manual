<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>sim_ddpcr. dpcR 0.2</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="
Michal Burdukiewicz, Stefan Roediger.
">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">dpcR 0.2</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>Simulate Droplet Digital PCR</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>sim_ddpcr(m, n, times, n_exp&nbsp;=&nbsp;1, dube&nbsp;=&nbsp;FALSE, pos_sums&nbsp;=&nbsp;FALSE, fluo&nbsp;=&nbsp;NULL)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>m</dt>
      <dd>the total number of template molecules used in the expertiment. Must be
a positive integer.</dd>
      <dt>n</dt>
      <dd>the number of droplets per experiment. Must be a positive integer.</dd>
      <dt>times</dt>
      <dd>number of repetitions (see Details).</dd>
      <dt>n_exp</dt>
      <dd>the number of experiments that are simulated by the function.
Cannot have higher value than the <code>times</code> argument.</dd>
      <dt>dube</dt>
      <dd>if <code>TRUE</code>, the function is strict implementation of digital
PCR simulation (as in Dube et al., 2008). If <code>FALSE</code>, the function
calculates only approximation of Dube's experiment. See Details and
References.</dd>
      <dt>pos_sums</dt>
      <dd>if <code>TRUE</code>, function returns only the total number of
positive (containing at least one molecule) chamber per panel. If
<code>FALSE</code>, the functions returns a vector of length equal to the number
of chambers. Each element of the vector represents the number of template
molecules in a given chamber.</dd>
      <dt>fluo</dt>
      <dd>if <code>NULL</code>, the function calculates number of molecules per
well or total number of positive droplets. If list of two, the first
argument defines smoothness of the fluorescence curve and second space
between two consecutive measured droplets. Space must be a vector containing
positive integers of the length <code>n</code> or 1.</dd>
    </dl>
    
    <div class="Value">
      <h2>Value</h2>

      <p><dl>
If the <code>pos_sums</code> argument has value <code>FALSE</code>, the function
returns matrix with $n$ rows and $n_panels$ columns. Each column
represents one plate. The type of such simulation would be <code>"nm"</code>. If the
<code>pos_sums</code> argument has value <code>TRUE</code>, the function return matrix
with one row and $n_panels$ columns. Each column contains the total
number of positive chambers in each plate and type of simulation would be
set as <code>"tnp"</code>.</p>
  
      <p>In each case the value is an object of the <code>ddpcr</code> class.
</dl></p>
  
    </div>

    <div class="Description">
      <h2>Description</h2>

      <p>A function that simulates results of a droplet digital PCR.</p>
  
    </div>

    <div class="Details">
      <h2>Details</h2>

      <p>The function contains two
implementations of the array digital PCR simulation. First one was described
in Dube at. al (2008). This method is based on random distributing $m * times$ molecules between $n * times$
chambers.  After this step, the required number of plates is created by the
random sampling of chambers without replacement. The above method is used,
when the <code>dube</code> argument has value <code>TRUE</code>.</p>
  
      <p>The higher the value of the argument <code>times</code>, the simulation result is
closer to theoretical calculations.</p>
  
    </div>

    <div class="Note">
      <h2>Note</h2>

      <p>Although Dube's simulation of digital PCR was developed for array
digital PCR, it's also viable for simulating droplet-based methods.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'>#simulate fluorescence data
tmp_VIC &lt;- sim_ddpcr(m = 7, n = 20, times = 5, fluo = list(0.1, 0))
tmp_FAM &lt;- sim_ddpcr(m = 15, n = 20, times = 5, fluo = list(0.1, 0))
par(mfrow = c(2,1))
plot(tmp_VIC, col = &quot;green&quot;, type = &quot;l&quot;)
plot(tmp_FAM, col = &quot;blue&quot;, type = &quot;l&quot;)
</div>
<p><img src='sim_ddpcr-2.png' alt='' width='540' height='400' /></p>
<div class='input'>summary(tmp_FAM)
</div>
<div class='output'>
Number of positive partitions: 11 
Total number of partitions:    20 

Number of runs:        1 
Number of experiments: 1 

  experiment replicate   assay method    lambda lambda.low lambda.up        m     m.low     m.up  k  n
 Experiment1         1 Unknown   dube 0.7985077  0.4034189  1.461157 15.97015  8.068377 29.22314 11 20
 Experiment1         1 Unknown   bhat 0.7985077  0.5513011  1.045714 15.97015 11.026022 20.91429 11 20
</div>
<div class='input'>
summary(sim_ddpcr(m = 7, n = 20, times = 5, n_exp = 5))
</div>
<div class='output'>
Number of positive partitions: 7, 6, 7, 6, ... 
Total number of partitions:    20, 20, 20, 20, ... 

Number of runs:        5 
Number of experiments: 1 

  experiment replicate   assay method    lambda lambda.low lambda.up        m    m.low     m.up k  n
 Experiment1         1 Unknown   dube 0.4307829 0.15194293 0.8187950 8.615658 3.038859 16.37590 7 20
 Experiment1         1 Unknown   bhat 0.4307829 0.26670039 0.5948654 8.615658 5.334008 11.89731 7 20
 Experiment1         2 Unknown   dube 0.3566749 0.10443145 0.6948217 7.133499 2.088629 13.89643 6 20
 Experiment1         2 Unknown   bhat 0.3566749 0.21028993 0.5030600 7.133499 4.205799 10.06120 6 20
 Experiment1         3 Unknown   dube 0.4307829 0.15194293 0.8187950 8.615658 3.038859 16.37590 7 20
 Experiment1         3 Unknown   bhat 0.4307829 0.26670039 0.5948654 8.615658 5.334008 11.89731 7 20
 Experiment1         4 Unknown   dube 0.3566749 0.10443145 0.6948217 7.133499 2.088629 13.89643 6 20
 Experiment1         4 Unknown   bhat 0.3566749 0.21028993 0.5030600 7.133499 4.205799 10.06120 6 20
 Experiment1         5 Unknown   dube 0.2876821 0.06211724 0.5794127 5.753641 1.242345 11.58825 5 20
 Experiment1         5 Unknown   bhat 0.2876821 0.15858263 0.4167815 5.753641 3.171653  8.33563 5 20
</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>sim_ddpcr</li>
    </ul>
    <ul>
      <li>datagen</li>
    </ul> -->
      
    <h2>See also</h2>
    
<code><a href='sim_adpcr.html'>sim_adpcr</a></code>.

    
    <h2>Author</h2>
    
Michal Burdukiewicz, Stefan Roediger.

    
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>