<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>dpcR package - an overview &bull; dpcR</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">dpcR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/michbur/dpcR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>dpcR package - an overview</h1>
                        <h4 class="author">Micha&#322; Burdukiewicz, Stefan R&ouml;diger</h4>
            
            <h4 class="date">2016-10-31</h4>
          </div>

    
    
<div class="contents">
<p><strong>dpcR</strong> is an R package designed to perform analysis of digital PCR (dPCR) experiments. This vignette covers important features of the package and should be used as an addendum to the manual.</p>
<p>Our <strong>dpcR</strong> package employs the nomenclature of the MIQE guidelines for dPCR (<span class="citation">Jim F Huggett et al. (2013)</span>, <span class="citation">Jim F. Huggett, Cowen, and Foy (2014)</span>). <span class="math inline">\(\lambda\)</span> is the mean number of molecules per partition. Total number of partitions is given by <span class="math inline">\(n\)</span>. <span class="math inline">\(k\)</span> is the number of positive partitions.</p>
<p><span class="math display">\[
\lambda = - \ln \left(1 - \frac{k}{n} \right)
\]</span></p>
<p>We firstly describe <code>dpcr</code> class, a parent class for all classes designed to contain dPCR data. Further, we inspect closer <code>adpcr</code> class responsible for array-based dPCR experiments (all experiments, where output data has precise localization in two dimensions).</p>
<p>TO DO ddpcr</p>
<p>Real-time quantitative qPCR (qPCR) experiments do not follow the fundamental assumption of dPCR reactions (the mean number of template molecule per partition smaller than 1). However, it is possible to &lsquo;convert&rsquo; the qPCR. We present a tool to analyze results from <em>high-throughput</em> qPCR systems by using the dPCR analysis methodology as implemented in the <strong>dpcR</strong> package. The <code>qpcr2pp</code> function converts qPCR amplification curve data to a <code>qdpcr</code> object (see section about <code>qdpcr</code>). The calculation of the Cq&rsquo;s from the amplification curves is internally done via functions from the <strong>qpcR</strong> package by <span class="citation">Ritz and Spiess (2008)</span>.</p>
<div id="dpcr-object" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#dpcr-object" class="anchor"> </a></body></html><code>dpcr</code> object</h1>
<p>The key class of the <strong>dpcR</strong> package is <code>dpcr</code>. It has the following slots:<br>
* <em>.Data</em> - matrix containing data from dPCR runs (see &lsquo;<em>.Data</em> slot&rsquo; subsection). It is further specified by the <em>type</em> slot.<br>
* <em>n</em> - number of partitions read in each run.<br>
* <em>exper</em> - name of the experiment.<br>
* <em>replicate</em> - name (or more conveniently ID) of a replicate.<br>
* <em>assay</em> - name of the assay.<br>
* <em>type</em> - name of the data (see &lsquo;<em>type</em> slot&rsquo; subsection)</p>
<p>Although, this class is designed to contain results from all dPCR experiments, the user will interact mostly with its inheritors as <code>adpcr</code> or <code>dpcr</code>.</p>
<p><code>dpcr</code> is a S4 object. Below is shown how to extract elements from the slots of a S4 object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Below we have S4 object</span>
s4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_adpcr.html">sim_adpcr</a></span>(<span class="dt">m =</span> <span class="dv">100</span>, <span class="dt">n =</span> <span class="dv">496</span>, <span class="dt">times =</span> <span class="dv">100</span>, <span class="dt">pos_sums =</span> <span class="ot">FALSE</span>, <span class="dt">n_panels =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>## The assumed volume of partitions in each run is equal to 1.</code></pre>
<pre><code>## The assumed volume uncertainty in each run is equal to 0.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Is it a dpcr object?</span>
<span class="kw">class</span>(s4)</code></pre></div>
<pre><code>## [1] "adpcr"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Yes, it is. Let's see what we have in type slot</span>
<span class="kw">slot</span>(s4, <span class="st">"type"</span>)</code></pre></div>
<pre><code>## [1] "nm"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We can use also shorter notation</span>
s4@type</code></pre></div>
<pre><code>## [1] "nm"</code></pre>
<div id="dpcr-objects-management-bind_dpcr-extract_run" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#dpcr-objects-management-bind_dpcr-extract_run" class="anchor"> </a></body></html><code>dpcr</code> objects management (<code>bind_dpcr</code>, <code>extract_run</code>)</h2>
<p>All <code>dpcr</code> objects should be managed using special functions provided by this package: <code>bind_dpcr</code> and <code>extract_run</code>. The former binds <code>dpcr</code> objects, the latter extracts parts of the <code>dpcr</code> object. It is important to use this functions, because they preserve other attributes important for <code>dpcr</code> objects as number of partitions, names of experiments, assays and technical replicates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create single adpcr object. The following code is also true for </span>
<span class="co"># other objects inhering from dpcr, as dpcr or qdpcr</span>
single_run &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_adpcr.html">sim_adpcr</a></span>(<span class="dt">m =</span> <span class="dv">100</span>, <span class="dt">n =</span> <span class="dv">765</span>, <span class="dt">times =</span> <span class="dv">100</span>, <span class="dt">pos_sums =</span> <span class="ot">FALSE</span>, <span class="dt">n_panels =</span> <span class="dv">1</span>)
two_runs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bind_dpcr-methods.html">bind_dpcr</a></span>(single_run, single_run)
three_runs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bind_dpcr-methods.html">bind_dpcr</a></span>(single_run, single_run, single_run)
<span class="co"># It is also possible to bind a list of dpcr objects... </span>
three_runs_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bind_dpcr-methods.html">bind_dpcr</a></span>(<span class="kw">list</span>(single_run, single_run, single_run))
<span class="co"># ... which may be useful in do.call statements</span>
dpcr_list &lt;-<span class="st"> </span><span class="kw">do.call</span>(bind_dpcr, <span class="kw">lapply</span>(5L:<span class="dv">10</span>*<span class="dv">10</span>, function(n_template)
  <span class="kw"><a href="../reference/sim_adpcr.html">sim_adpcr</a></span>(<span class="dt">m =</span> n_template, <span class="dt">n =</span> <span class="dv">765</span>, <span class="dt">times =</span> <span class="dv">100</span>, <span class="dt">pos_sums =</span> <span class="ot">FALSE</span>, <span class="dt">n_panels =</span> <span class="dv">1</span>)))</code></pre></div>
<p><code>bind_dpcr</code> may be seen as the analogue of the R function <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/cbind.html">cbind</a>. The main difference is the lack of recycling. If two objects with uneven number of data points are bound together, the shorter is completed with NA values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">longer_run &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_adpcr.html">sim_adpcr</a></span>(<span class="dt">m =</span> <span class="dv">10</span>, <span class="dt">n =</span> <span class="dv">15</span>, <span class="dt">times =</span> <span class="dv">100</span>, <span class="dt">pos_sums =</span> <span class="ot">FALSE</span>, <span class="dt">n_panels =</span> <span class="dv">1</span>)
shorter_run &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_adpcr.html">sim_adpcr</a></span>(<span class="dt">m =</span> <span class="dv">10</span>, <span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">times =</span> <span class="dv">100</span>, <span class="dt">pos_sums =</span> <span class="ot">FALSE</span>, <span class="dt">n_panels =</span> <span class="dv">1</span>)
shortest_run &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_adpcr.html">sim_adpcr</a></span>(<span class="dt">m =</span> <span class="dv">10</span>, <span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">times =</span> <span class="dv">100</span>, <span class="dt">pos_sums =</span> <span class="ot">FALSE</span>, <span class="dt">n_panels =</span> <span class="dv">1</span>)
<span class="co"># Expect informative message after binding</span>
res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bind_dpcr-methods.html">bind_dpcr</a></span>(longer_run, shorter_run, shortest_run)</code></pre></div>
<pre><code>## Different number of partitions. Shorter objects completed with NA values.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Print the whole data</span>
<span class="kw">slot</span>(res, <span class="st">".Data"</span>)</code></pre></div>
<pre><code>##       Experiment11.1 Experiment12.1 Experiment12.1
##  [1,]              0              3              2
##  [2,]              0              1              1
##  [3,]              1              0              3
##  [4,]              1              0              2
##  [5,]              0              0              1
##  [6,]              1              0             NA
##  [7,]              1              0             NA
##  [8,]              1              3             NA
##  [9,]              0              1             NA
## [10,]              1              3             NA
## [11,]              0             NA             NA
## [12,]              0             NA             NA
## [13,]              3             NA             NA
## [14,]              0             NA             NA
## [15,]              1             NA             NA</code></pre>
<p><code>extract_run</code> is an equivalent of <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Extract.html">Extract</a>. It extracts one or more runs from the <code>dpcr</code> objects preserving other properties (as an adequate replicate ID and so on).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">five_runs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_adpcr.html">sim_adpcr</a></span>(<span class="dt">m =</span> <span class="dv">2</span>, <span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">times =</span> <span class="dv">100</span>, <span class="dt">pos_sums =</span> <span class="ot">FALSE</span>, <span class="dt">n_panels =</span> <span class="dv">5</span>)</code></pre></div>
<pre><code>## The assumed volume of partitions in each run is equal to 1.</code></pre>
<pre><code>## The assumed volume uncertainty in each run is equal to 0.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(five_runs)</code></pre></div>
<pre><code>##      Experiment1.1 Experiment1.2 Experiment1.3 Experiment1.4 Experiment1.5
## [1,]             0             0             0             1             0
## [2,]             1             0             0             0             1
## [3,]             0             0             1             0             0
## [4,]             0             0             0             0             0
## [5,]             0             0             0             0             0
## 
## 5 data points ommited.
## Data type: 'nm'</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extract runs by the index</span>
only_first_run &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extract_run.html">extract_run</a></span>(five_runs, <span class="dv">1</span>)
only_first_and_second_run &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extract_run.html">extract_run</a></span>(five_runs, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="co"># See if proper replicated were extracted</span>
<span class="kw">slot</span>(only_first_and_second_run, <span class="st">"replicate"</span>)</code></pre></div>
<pre><code>## [1] 1 2
## Levels: 1 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">no_first_run &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extract_run.html">extract_run</a></span>(five_runs, -<span class="dv">1</span>)
<span class="kw">slot</span>(no_first_run, <span class="st">"replicate"</span>)</code></pre></div>
<pre><code>## [1] 2 3 4 5
## Levels: 2 3 4 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extract runs by the name</span>
run_Experiment1<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extract_run.html">extract_run</a></span>(five_runs, <span class="st">"Experiment1.3"</span>)
<span class="kw">slot</span>(run_Experiment1<span class="fl">.3</span>, <span class="st">"replicate"</span>)</code></pre></div>
<pre><code>## [1] 3
## Levels: 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">run_Experiment1.3and5 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extract_run.html">extract_run</a></span>(five_runs, <span class="kw">c</span>(<span class="st">"Experiment1.3"</span>, <span class="st">"Experiment1.5"</span>))
<span class="kw">slot</span>(run_Experiment1.3and5, <span class="st">"replicate"</span>)</code></pre></div>
<pre><code>## [1] 3 5
## Levels: 3 5</code></pre>
<p>Since the <em>.Data</em> slot inherits from the matrix class, it is possible to also use normal <em>Extract</em> operator (&lsquo;[&rsquo;). For more information about this topic, see &lsquo;<em>.Data</em> slot&rsquo; subsection.</p>
</div>
<div id="data-slot" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#data-slot" class="anchor"> </a></body></html><em>.Data</em> slot</h2>
<p>Digital PCR data is always a matrix (see <code>?matrix</code> in R). Columns and rows represent respectively individual runs and their data points. Since data points are not always equivalent to partitions, the true number of partitions for each run is always defined in slot <em>n</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create two array dPCR experiments. Mind the difference in the n parameter.</span>
sample_adpcr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bind_dpcr-methods.html">bind_dpcr</a></span>(<span class="kw"><a href="../reference/sim_adpcr.html">sim_adpcr</a></span>(<span class="dt">m =</span> <span class="dv">100</span>, <span class="dt">n =</span> <span class="dv">765</span>, <span class="dt">times =</span> <span class="dv">100</span>, <span class="dt">pos_sums =</span> <span class="ot">FALSE</span>, <span class="dt">n_panels =</span> <span class="dv">1</span>), 
                          <span class="kw"><a href="../reference/rename_dpcr.html">rename_dpcr</a></span>(<span class="kw"><a href="../reference/sim_adpcr.html">sim_adpcr</a></span>(<span class="dt">m =</span> <span class="dv">100</span>, <span class="dt">n =</span> <span class="dv">763</span>, <span class="dt">times =</span> <span class="dv">100</span>, <span class="dt">pos_sums =</span> <span class="ot">FALSE</span>, 
                                           <span class="dt">n_panels =</span> <span class="dv">1</span>), 
                                 <span class="dt">exper =</span> <span class="st">"Experiment2"</span>))</code></pre></div>
<pre><code>## Different number of partitions. Shorter objects completed with NA values.</code></pre>
<p>In the code chunk above we created two array dPCR experiments with respectively 765 and 763 partitions. See the last five data points:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># It's possible to manipulate data points from dpcr object using all functions that work for matrices</span>
<span class="kw">tail</span>(sample_adpcr)</code></pre></div>
<pre><code>##        Experiment1.1 Experiment2.1
## [760,]             0             0
## [761,]             0             0
## [762,]             1             0
## [763,]             0             0
## [764,]             0            NA
## [765,]             0            NA</code></pre>
<p>Both experiments have 765 data points. We see that in case of shorter experiment, 2 data points has value NA. If we analyze the <em>n</em> slot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">slot</span>(sample_adpcr, <span class="st">"n"</span>)</code></pre></div>
<pre><code>## [1] 765 763</code></pre>
<p>We see the expected number of partitions. It is especially important in case of fluorescence dPCR data, where one droplet may have assigned few data points.</p>
<p>The important feature of <em>.Data</em> is inheritance from <code>matrix</code> class, which opens numerous possibilities for data manipulation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Quickly count positive partitions</span>
<span class="kw">colSums</span>(sample_adpcr &gt;<span class="st"> </span><span class="dv">0</span>)</code></pre></div>
<pre><code>## Experiment1.1 Experiment2.1 
##            92            NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Baseline fluorescence data</span>
<span class="kw"><a href="../reference/sim_dpcr.html">sim_dpcr</a></span>(<span class="dt">m =</span> <span class="dv">3</span>, <span class="dt">n =</span> <span class="dv">2</span>, <span class="dt">times =</span> <span class="dv">5</span>, <span class="dt">fluo =</span> <span class="kw">list</span>(<span class="fl">0.1</span>, <span class="dv">0</span>)) -<span class="st"> </span><span class="fl">0.05</span></code></pre></div>
<pre><code>##      Experiment1.1
## [1,]   -0.05000000
## [2,]    0.04983342
## [3,]    0.14866933
## [4,]    0.24552021
## [5,]    0.33941834
## 
## 59 data points ommited.
## Data type: 'fluo'</code></pre>
</div>
<div id="type-slot" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#type-slot" class="anchor"> </a></body></html><em>type</em> slot</h2>
<p>Data from dPCR experiments may have several types:<br>
* <strong>ct</strong> (<strong>c</strong>ycle <strong>t</strong>hreshold): cycle threshold of each partition.<br>
* <strong>fluo</strong>: fluorescence intensity of each partition.<br>
* <strong>nm</strong> (<strong>n</strong>umber of <strong>m</strong>olecules): number of molecules in each partition (usually such precise data come only from simulations).<br>
* <strong>np</strong> (<strong>n</strong>umber of <strong>p</strong>ositives): status (positive (1) or negative(0)) of each partition.<br>
* <strong>tnp</strong> (<strong>t</strong>otal <strong>n</strong>umber of <strong>p</strong>ositives): total number of positive partitions in the run (<em>.Data</em> in this case is matrix with single row and number of columns equal to the number of runs).</p>
<p>In case of <strong>fluo</strong> and <strong>tnp</strong> types, the number of data points in <em>.Data</em> slot is almost never equal to the real number of partitions <code>dpcr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Inspect all types of data</span>

<span class="co"># Cq</span>
<span class="co"># Load package with qPCR data</span>
<span class="kw">library</span>(chipPCR)
<span class="kw"><a href="../reference/qpcr2pp.html">qpcr2pp</a></span>(<span class="dt">data =</span> C127EGHP[, 1L:<span class="dv">6</span>], <span class="dt">type =</span> <span class="st">"ct"</span>)</code></pre></div>
<pre><code>##       qPCR1.1
## [1,] 34.09434
## [2,] 13.00000
## [3,] 12.26415
## [4,] 12.75472
## [5,] 12.26415
## 
## Data type: 'ct'</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># fluo</span>
<span class="kw"><a href="../reference/sim_dpcr.html">sim_dpcr</a></span>(<span class="dt">m =</span> <span class="dv">3</span>, <span class="dt">n =</span> <span class="dv">2</span>, <span class="dt">times =</span> <span class="dv">5</span>, <span class="dt">fluo =</span> <span class="kw">list</span>(<span class="fl">0.1</span>, <span class="dv">0</span>)) -<span class="st"> </span><span class="fl">0.05</span></code></pre></div>
<pre><code>##      Experiment1.1
## [1,]    -0.0500000
## [2,]     0.1496668
## [3,]     0.3473387
## [4,]     0.5410404
## [5,]     0.7288367
## 
## 59 data points ommited.
## Data type: 'fluo'</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># nm</span>
<span class="kw"><a href="../reference/sim_adpcr.html">sim_adpcr</a></span>(<span class="dt">m =</span> <span class="dv">235</span>, <span class="dt">n =</span> <span class="dv">765</span>, <span class="dt">times =</span> <span class="dv">100</span>, <span class="dt">pos_sums =</span> <span class="ot">FALSE</span>, <span class="dt">n_panels =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>## The assumed volume of partitions in each run is equal to 1.</code></pre>
<pre><code>## The assumed volume uncertainty in each run is equal to 0.</code></pre>
<pre><code>##      Experiment1.1 Experiment1.2 Experiment1.3
## [1,]             0             0             0
## [2,]             1             0             1
## [3,]             1             0             0
## [4,]             0             1             0
## [5,]             0             0             0
## 
## 760 data points ommited.
## Data type: 'nm'</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># np</span>
<span class="kw"><a href="../reference/binarize.html">binarize</a></span>(<span class="kw"><a href="../reference/sim_adpcr.html">sim_adpcr</a></span>(<span class="dt">m =</span> <span class="dv">235</span>, <span class="dt">n =</span> <span class="dv">765</span>, <span class="dt">times =</span> <span class="dv">100</span>, <span class="dt">pos_sums =</span> <span class="ot">FALSE</span>, <span class="dt">n_panels =</span> <span class="dv">3</span>))</code></pre></div>
<pre><code>## The assumed volume of partitions in each run is equal to 1.
## The assumed volume uncertainty in each run is equal to 0.</code></pre>
<pre><code>##      Experiment1.1 Experiment1.2 Experiment1.3
## [1,]             0             0             0
## [2,]             0             0             0
## [3,]             0             0             0
## [4,]             0             0             0
## [5,]             0             0             0
## 
## 760 data points ommited.
## Data type: 'np'</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># tnp</span>
<span class="kw"><a href="../reference/sim_adpcr.html">sim_adpcr</a></span>(<span class="dt">m =</span> <span class="dv">235</span>, <span class="dt">n =</span> <span class="dv">765</span>, <span class="dt">times =</span> <span class="dv">100</span>, <span class="dt">pos_sums =</span> <span class="ot">TRUE</span>, <span class="dt">n_panels =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>## The assumed volume of partitions in each run is equal to 1.
## The assumed volume uncertainty in each run is equal to 0.</code></pre>
<pre><code>##      Experiment1.1 Experiment1.2 Experiment1.3
## [1,]           213           197           204
## 
## Data type: 'tnp'</code></pre>
</div>
</div>
<div id="dpcr-workflow" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#dpcr-workflow" class="anchor"> </a></body></html>dpcR workflow</h1>
<embed src="workflow.svg" type="image/svg+xml"></embed><div id="read-data" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#read-data" class="anchor"> </a></body></html>Read data</h2>
<p>The <code>read_dpcr</code> function is responsible for importing data from external file sources into R working space. The additional parameters allow specification of the format type and other details.</p>
<p>Additionally, we advise using other packages belonging do the pcRuniversum such as <a href="http://cran.r-project.org/package=RDML">RDML</a> or dedicated packages such as ReadqPCR (<a href="http://www.bioconductor.org/packages/release/bioc/html/ReadqPCR.html">available from bioconductor.org</a>). Further information can be found in <span class="citation">Pabinger et al. (2014)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generate some data from 15x16 array. Let's presume, that we have results from two plates</span>
sample_runs &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rpois</span>(<span class="dv">480</span>, <span class="dt">lambda =</span> <span class="fl">1.5</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)
<span class="co"># Check its class - it's a typical R structure</span>
<span class="kw">class</span>(sample_runs)</code></pre></div>
<pre><code>## [1] "matrix"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Save it to adpcr object</span>
adpcr_experiments &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_dpcr.html">create_dpcr</a></span>(sample_runs, <span class="dt">n =</span> <span class="kw">c</span>(240L, 240L), <span class="dt">type =</span> <span class="st">"nm"</span>, <span class="dt">adpcr =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## The assumed volume of partitions in each run is equal to 1.</code></pre>
<pre><code>## The assumed volume uncertainty in each run is equal to 0.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(adpcr_experiments)</code></pre></div>
<pre><code>## [1] "adpcr"</code></pre>
</div>
<div id="summary-method" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#summary-method" class="anchor"> </a></body></html>Summary method</h2>
<p><code>Summary</code> method produces a tabelary summary of any <code>dpcr</code> object. It calculates &lambda; and its confidence intervals using both Dube&rsquo;s and Bhat&rsquo;s method. The estimated number of template molecules (m) is also computed using the following relationship:</p>
<p><span class="math display">\[
m = n \lambda
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/summary-methods.html">summary</a></span>(six_panels)</code></pre></div>
<pre><code>## 
## Number of positive partitions: 10, 9, 41, 38, ... 
## Total number of partitions:    765, 765, 765, 765, ... 
## 
## Number of runs:        6 
## Number of experiments: 3 
## 
##   experiment replicate assay method     lambda  lambda.low  lambda.up
##  Experiment1         1  Chr4   dube 0.01315808 0.005035786 0.02134690
##  Experiment1         1  Chr4   bhat 0.01315808 0.008997103 0.01731907
##  Experiment1         2   MYC   dube 0.01183446 0.004132446 0.01959625
##  Experiment1         2   MYC   bhat 0.01183446 0.007889615 0.01577930
##  Experiment2         1  Chr4   dube 0.05508444 0.038361846 0.07209145
##  Experiment2         1  Chr4   bhat 0.05508444 0.046480609 0.06368827
##  Experiment2         2   MYC   dube 0.05094936 0.034878187 0.06728303
##  Experiment2         2   MYC   bhat 0.05094936 0.042683385 0.05921533
##  Experiment3         1  Chr4   dube 0.14612199 0.118401562 0.17463281
##  Experiment3         1  Chr4   bhat 0.14612199 0.131780803 0.16046319
##  Experiment3         2   MYC   dube 0.13409177 0.107602192 0.16130219
##  Experiment3         2   MYC   bhat 0.13409177 0.120395834 0.14778771
##          m      m.low      m.up          c       c.low       c.up   k   n
##   10.06593   3.852376  16.33038 0.01315808 0.005035786 0.02134690  10 765
##   10.06593   6.882784  13.24909 0.01315808 0.008997103 0.01731907  10 765
##    9.05336   3.161321  14.99113 0.01183446 0.004132446 0.01959625   9 765
##    9.05336   6.035556  12.07116 0.01183446 0.007889615 0.01577930   9 765
##   42.13960  29.346812  55.14996 0.05508444 0.038361846 0.07209145  41 765
##   42.13960  35.557666  48.72153 0.05508444 0.046480609 0.06368827  41 765
##   38.97626  26.681813  51.47152 0.05094936 0.034878187 0.06728303  38 765
##   38.97626  32.652790  45.29973 0.05094936 0.042683385 0.05921533  38 765
##  111.78333  90.577195 133.59410 0.14612199 0.118401562 0.17463281 104 765
##  111.78333 100.812314 122.75434 0.14612199 0.131780803 0.16046319 104 765
##  102.58021  82.315677 123.39618 0.13409177 0.107602192 0.16130219  96 765
##  102.58021  92.102813 113.05760 0.13409177 0.120395834 0.14778771  96 765</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Save summary data without printing it</span>
summ &lt;-<span class="st"> </span><span class="kw"><a href="../reference/summary-methods.html">summary</a></span>(six_panels, <span class="dt">print =</span> <span class="ot">FALSE</span>)
<span class="co"># Print only the summary table</span>
summ[[<span class="st">"summary"</span>]]</code></pre></div>
<pre><code>##     experiment replicate assay method     lambda  lambda.low  lambda.up
## 1  Experiment1         1  Chr4   dube 0.01315808 0.005035786 0.02134690
## 2  Experiment1         1  Chr4   bhat 0.01315808 0.008997103 0.01731907
## 3  Experiment1         2   MYC   dube 0.01183446 0.004132446 0.01959625
## 4  Experiment1         2   MYC   bhat 0.01183446 0.007889615 0.01577930
## 5  Experiment2         1  Chr4   dube 0.05508444 0.038361846 0.07209145
## 6  Experiment2         1  Chr4   bhat 0.05508444 0.046480609 0.06368827
## 7  Experiment2         2   MYC   dube 0.05094936 0.034878187 0.06728303
## 8  Experiment2         2   MYC   bhat 0.05094936 0.042683385 0.05921533
## 9  Experiment3         1  Chr4   dube 0.14612199 0.118401562 0.17463281
## 10 Experiment3         1  Chr4   bhat 0.14612199 0.131780803 0.16046319
## 11 Experiment3         2   MYC   dube 0.13409177 0.107602192 0.16130219
## 12 Experiment3         2   MYC   bhat 0.13409177 0.120395834 0.14778771
##            m      m.low      m.up          c       c.low       c.up   k
## 1   10.06593   3.852376  16.33038 0.01315808 0.005035786 0.02134690  10
## 2   10.06593   6.882784  13.24909 0.01315808 0.008997103 0.01731907  10
## 3    9.05336   3.161321  14.99113 0.01183446 0.004132446 0.01959625   9
## 4    9.05336   6.035556  12.07116 0.01183446 0.007889615 0.01577930   9
## 5   42.13960  29.346812  55.14996 0.05508444 0.038361846 0.07209145  41
## 6   42.13960  35.557666  48.72153 0.05508444 0.046480609 0.06368827  41
## 7   38.97626  26.681813  51.47152 0.05094936 0.034878187 0.06728303  38
## 8   38.97626  32.652790  45.29973 0.05094936 0.042683385 0.05921533  38
## 9  111.78333  90.577195 133.59410 0.14612199 0.118401562 0.17463281 104
## 10 111.78333 100.812314 122.75434 0.14612199 0.131780803 0.16046319 104
## 11 102.58021  82.315677 123.39618 0.13409177 0.107602192 0.16130219  96
## 12 102.58021  92.102813 113.05760 0.13409177 0.120395834 0.14778771  96
##      n
## 1  765
## 2  765
## 3  765
## 4  765
## 5  765
## 6  765
## 7  765
## 8  765
## 9  765
## 10 765
## 11 765
## 12 765</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extract results for Dube's method</span>
summ[[<span class="st">"summary"</span>]][summ[[<span class="st">"summary"</span>]][[<span class="st">"method"</span>]] ==<span class="st"> "dube"</span>, ]</code></pre></div>
<pre><code>##     experiment replicate assay method     lambda  lambda.low  lambda.up
## 1  Experiment1         1  Chr4   dube 0.01315808 0.005035786 0.02134690
## 3  Experiment1         2   MYC   dube 0.01183446 0.004132446 0.01959625
## 5  Experiment2         1  Chr4   dube 0.05508444 0.038361846 0.07209145
## 7  Experiment2         2   MYC   dube 0.05094936 0.034878187 0.06728303
## 9  Experiment3         1  Chr4   dube 0.14612199 0.118401562 0.17463281
## 11 Experiment3         2   MYC   dube 0.13409177 0.107602192 0.16130219
##            m     m.low      m.up          c       c.low       c.up   k   n
## 1   10.06593  3.852376  16.33038 0.01315808 0.005035786 0.02134690  10 765
## 3    9.05336  3.161321  14.99113 0.01183446 0.004132446 0.01959625   9 765
## 5   42.13960 29.346812  55.14996 0.05508444 0.038361846 0.07209145  41 765
## 7   38.97626 26.681813  51.47152 0.05094936 0.034878187 0.06728303  38 765
## 9  111.78333 90.577195 133.59410 0.14612199 0.118401562 0.17463281 104 765
## 11 102.58021 82.315677 123.39618 0.13409177 0.107602192 0.16130219  96 765</code></pre>
</div>
<div id="show-method" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#show-method" class="anchor"> </a></body></html>Show method</h2>
<p>Since the <code>dpcr</code> objects tends to have many data points and quickly clutter the console, the <code>show</code> function prints only first 5 rows of <em>.Data</em>, number of omitted rows and the type of the object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_dpcr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_dpcr.html">sim_dpcr</a></span>(<span class="dt">m =</span> <span class="dv">3</span>, <span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">times =</span> <span class="dv">5</span>)
<span class="co"># Standard show method...</span>
<span class="kw"><a href="../reference/show-methods.html">show</a></span>(sample_dpcr)</code></pre></div>
<pre><code>##      Experiment1.1
## [1,]             0
## [2,]             0
## [3,]             0
## [4,]             0
## [5,]             0
## 
## 5 data points ommited.
## Data type: 'nm'</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ... which is an equivalent of:</span>
sample_dpcr</code></pre></div>
<pre><code>##      Experiment1.1
## [1,]             0
## [2,]             0
## [3,]             0
## [4,]             0
## [5,]             0
## 
## 5 data points ommited.
## Data type: 'nm'</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># If you want to see all data points:</span>
<span class="kw">slot</span>(sample_dpcr, <span class="st">".Data"</span>)</code></pre></div>
<pre><code>##       Experiment1.1
##  [1,]             0
##  [2,]             0
##  [3,]             0
##  [4,]             0
##  [5,]             0
##  [6,]             0
##  [7,]             0
##  [8,]             1
##  [9,]             1
## [10,]             1</code></pre>
</div>
</div>
<div id="adpcr-class" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#adpcr-class" class="anchor"> </a></body></html><code>adpcr</code> class</h1>
<p>If the output if dPCR system has exact locations in two-dimensional space, it belongs to the <code>adpcr</code> class. It is the case for all dPCR experiments conducted on panels, arrays and so on. The <code>adpcr</code> object inherits from <code>dpcr</code> objects, but has special slots specifying the dimensions and their names.</p>
<p>The planar representation of <code>adpcr</code> objects is created by the <code>adpcr2panel</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/adpcr2panel.html">adpcr2panel</a></span>(six_panels)[[<span class="st">"Experiment3.1"</span>]][1L:<span class="dv">6</span>, 1L:<span class="dv">6</span>]</code></pre></div>
<pre><code>##   1   2   3   4   5   6  
## 1 "0" "0" "0" "1" "0" "0"
## 2 "0" "0" "1" "1" "0" "0"
## 3 "0" "0" "0" "0" "0" "0"
## 4 "0" "0" "0" "0" "0" "0"
## 5 "1" "0" "0" "1" "0" "0"
## 6 "0" "0" "0" "1" "0" "0"</code></pre>
<div id="array-visualisation" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#array-visualisation" class="anchor"> </a></body></html>Array visualisation</h2>
<p>Data from dPCR arrays can be easily visualized using the <code>plot_panel</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Remember, you can plot only single panel at once </span>
<span class="kw"><a href="../reference/plot_panel.html">plot_panel</a></span>(<span class="kw"><a href="../reference/extract_run.html">extract_run</a></span>(adpcr_experiments, <span class="dv">1</span>), <span class="dt">main =</span> <span class="st">"Experiment 1"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
<p>The same data can be visualized easily in binarized form (positive/negative partitions).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_panel.html">plot_panel</a></span>(<span class="kw"><a href="../reference/binarize.html">binarize</a></span>(<span class="kw"><a href="../reference/extract_run.html">extract_run</a></span>(adpcr_experiments, <span class="dv">1</span>)), <span class="dt">main =</span> <span class="st">"Experiment 1"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
<p>The <code>plot_panel</code> function returns invisibly coordinates, that are compatible with <strong>graphics</strong> and <strong>ggplot2</strong> packages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extract graphical coordinates</span>
panel_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_panel.html">plot_panel</a></span>(<span class="kw"><a href="../reference/extract_run.html">extract_run</a></span>(adpcr_experiments, <span class="dv">1</span>), <span class="dt">plot =</span> <span class="ot">FALSE</span>)
ggplot_coords &lt;-<span class="st"> </span><span class="kw">cbind</span>(panel_data[[<span class="st">"ggplot_coords"</span>]], <span class="dt">value =</span> <span class="kw">as.vector</span>(<span class="kw"><a href="../reference/extract_run.html">extract_run</a></span>(adpcr_experiments, <span class="dv">1</span>)))

<span class="co"># Plot panel using different graphics package</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(ggplot_coords, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> value)) +
<span class="st">  </span><span class="kw">geom_tile</span>()</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-17-1.png" width="576"></p>
</div>
<div id="array-testing" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#array-testing" class="anchor"> </a></body></html>Array testing</h2>
<p>The <code>test_panel</code> function is useful for testing the randomness of the spatial distribution of template molecules over the array.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The test_panel function performs a test for each experiment in apdr object.</span>
<span class="kw"><a href="../reference/test_panel.html">test_panel</a></span>(six_panels)</code></pre></div>
<pre><code>## $Experiment1.1
## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  single_panel
## X2 = 25, df = 24, p-value = 0.8115
## alternative hypothesis: two.sided
## 
## Quadrats: 5 by 5 grid of tiles
## 
## $Experiment1.2
## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  single_panel
## X2 = 21.556, df = 24, p-value = 0.7884
## alternative hypothesis: two.sided
## 
## Quadrats: 5 by 5 grid of tiles
## 
## $Experiment2.1
## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  single_panel
## X2 = 20.585, df = 24, p-value = 0.6739
## alternative hypothesis: two.sided
## 
## Quadrats: 5 by 5 grid of tiles
## 
## $Experiment2.2
## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  single_panel
## X2 = 23.842, df = 24, p-value = 0.9413
## alternative hypothesis: two.sided
## 
## Quadrats: 5 by 5 grid of tiles
## 
## $Experiment3.1
## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  single_panel
## X2 = 24.846, df = 24, p-value = 0.8283
## alternative hypothesis: two.sided
## 
## Quadrats: 5 by 5 grid of tiles
## 
## $Experiment3.2
## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  single_panel
## X2 = 21.708, df = 24, p-value = 0.8067
## alternative hypothesis: two.sided
## 
## Quadrats: 5 by 5 grid of tiles</code></pre>
<p>Further tests are available in the <strong>spatstat</strong> package, which is also utilizing S4 object system. The exchange of data between <strong>dpcR</strong> and <strong>spatstat</strong> packages is streamlined by the <code>adpcr2ppp</code> function, which converts <code>adpcr</code> object to <a href="http://finzi.psych.upenn.edu/library/spatstat/html/ppp.object.html">ppp</a> class taking into account spatial coordinates of positive partitions.</p>
</div>
</div>
<div id="qdpcr-class" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#qdpcr-class" class="anchor"> </a></body></html><code>qdpcr</code> class</h1>
<p>The unique feature of <strong>dpcR</strong> package is conversion of qPCR data to dPCR-like experiments. The qPCR data should be in a format as used by the <strong>qpcR</strong> package (see <a href="http://finzi.psych.upenn.edu/library/qpcR/html/qpcR_datasets.html">qpcR_datasets</a>), where columns represents particular experiments and one column contains cycle number. For pre-processing of raw amplification curve data we recommend the <strong>chipPCR</strong> package (<span class="citation">R&ouml;diger, Burdukiewicz, and Schierack (2015)</span>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load chiPCR package to access C317.amp data</span>
<span class="kw">library</span>(chipPCR)

<span class="co"># Convert data to qdpcr object</span>
qdat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/qpcr2pp.html">qpcr2pp</a></span>(<span class="dt">data =</span> C317.amp, <span class="dt">type =</span> <span class="st">"np"</span>, <span class="dt">Cq_range =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">30</span>))</code></pre></div>
<p><code>qdpcr</code> inherits from <code>dpcr</code> objects and may be analyzed using above mentioned methods. Moreover, the converted data may visualized using the <code>plot</code> method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(qdat)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-20-1.png" width="576"></p>
</div>
<div id="comparison-of-the-experiments" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#comparison-of-the-experiments" class="anchor"> </a></body></html>Comparison of the experiments</h1>
<div id="glm" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#glm" class="anchor"> </a></body></html>GLM</h2>
<p>Generalized Linear Models (GLM) are linear models for data, where the response variables may have non-normal distributions (as for example binomial distributed positive partitions in dPCR experiments). Using GLM we can describe relationships between results of dPCR:</p>
<p><span class="math display">\[\log{Y} = \beta^T X\]</span></p>
<p>where <span class="math inline">\(Y\)</span> are counts, <span class="math inline">\(X\)</span> are experiments names (categorical data) and <span class="math inline">\(\beta\)</span> are linear model coefficients for every experiment. Moreover, <span class="math inline">\(\exp{\beta} = \lambda\)</span>.</p>
<p>Estimated means copies per partitions obtained from the model are compared each other using multiple t-test.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compare experiments using GLM</span>

<span class="co"># 1. Perform test</span>
comp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/test_counts.html">test_counts</a></span>(six_panels)

<span class="co"># 2. See summary of the test</span>
<span class="kw"><a href="../reference/summary-methods.html">summary</a></span>(comp)</code></pre></div>
<pre><code>##   group     lambda lambda.low  lambda.up experiment replicate     k   n
## 1     1 0.01249627 0.00544639 0.02855430          1       1.5   9.5 765
## 2     2 0.05301690 0.03492520 0.08011674          2       1.5  39.5 765
## 3     3 0.14010688 0.10753792 0.18168399          3       1.5 100.0 765</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 3. Plot results of the test </span>
<span class="kw">plot</span>(comp, <span class="dt">aggregate =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-21-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 4. Aggregate runs to their groups</span>
<span class="kw">plot</span>(comp, <span class="dt">aggregate =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-21-2.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 5. Extract coefficients for the further usage</span>
<span class="kw">coef</span>(comp)</code></pre></div>
<pre><code>##               group     lambda  lambda.low  lambda.up  experiment
## Experiment1.1     1 0.01315808 0.005846969 0.02947734 Experiment1
## Experiment1.2     1 0.01183446 0.005045810 0.02763125 Experiment1
## Experiment2.1     2 0.05508444 0.036558214 0.08261881 Experiment2
## Experiment2.2     2 0.05094936 0.033292194 0.07761466 Experiment2
## Experiment3.1     3 0.14612199 0.112712519 0.18853961 Experiment3
## Experiment3.2     3 0.13409177 0.102363320 0.17482837 Experiment3
##               replicate   k   n
## Experiment1.1         1  10 765
## Experiment1.2         2   9 765
## Experiment2.1         1  41 765
## Experiment2.2         2  38 765
## Experiment3.1         1 104 765
## Experiment3.2         2  96 765</code></pre>
<p>The Poisson regression on binary data (positive/negative partition) can be used only when the concentration of template molecules in samples is small (positive partitions contain rarely more than 1 template particle). Higher concentrations requires binomial regression.</p>
</div>
<div id="multiple-tests" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#multiple-tests" class="anchor"> </a></body></html>Multiple tests</h2>
<p>The dPCR experiments may be also compared pairwise using the uniformly most powerful (UMP) ratio test <span class="citation">(Fay 2010)</span>. Furthermore, computed p-values are adjusted using Benjamini &amp; Hochberg correction <span class="citation">(Benjamini and Hochberg 1995)</span> to control family-wise error rate.</p>
<p>The UMP ratio test has following null-hypothesis:</p>
<p><span class="math display">\[
H_0: \frac{\lambda_1}{\lambda_2} = 1
\]</span></p>
<p>The generally advised Wilson&rsquo;s confidence intervals <span class="citation">(Brown, Cai, and DasGupta 2001)</span> are computed independently for every dPCR experiment. The confidence intervals are adjusted using Dunn &ndash; &Scaron;id&aacute;k correction to ensure that they simultaneously contain true value of <span class="math inline">\(lambda\)</span>:</p>
<p><span class="math display">\[
\alpha_{\text{adj}} = 1 - (1 - \alpha)^\frac{1}{T}
\]</span></p>
<p>For example, the 0.95 significance levels means, that probability of the all real values being in the range of its respective confidence intervals is 0.95.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#1. Perform multiple test comparison using data from the previous example</span>
comp_ratio &lt;-<span class="st"> </span><span class="kw"><a href="../reference/test_counts.html">test_counts</a></span>(six_panels, <span class="dt">model =</span> <span class="st">"ratio"</span>)

<span class="co">#2. See summary of the test</span>
<span class="kw"><a href="../reference/summary-methods.html">summary</a></span>(comp_ratio)</code></pre></div>
<pre><code>##   group     lambda lambda.low  lambda.up experiment replicate     k   n
## 1     1 0.01249627 0.00544639 0.02855430          1       1.5   9.5 765
## 2     2 0.05301690 0.03492520 0.08011674          2       1.5  39.5 765
## 3     3 0.14010688 0.10753792 0.18168399          3       1.5 100.0 765</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#3. Plot results of the test </span>
<span class="kw">plot</span>(comp_ratio, <span class="dt">aggregate =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-22-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#4. Aggregate runs to their groups</span>
<span class="kw">plot</span>(comp_ratio, <span class="dt">aggregate =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-22-2.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#5. Extract coefficients for the further usage</span>
<span class="kw">coef</span>(comp)</code></pre></div>
<pre><code>##               group     lambda  lambda.low  lambda.up  experiment
## Experiment1.1     1 0.01315808 0.005846969 0.02947734 Experiment1
## Experiment1.2     1 0.01183446 0.005045810 0.02763125 Experiment1
## Experiment2.1     2 0.05508444 0.036558214 0.08261881 Experiment2
## Experiment2.2     2 0.05094936 0.033292194 0.07761466 Experiment2
## Experiment3.1     3 0.14612199 0.112712519 0.18853961 Experiment3
## Experiment3.2     3 0.13409177 0.102363320 0.17482837 Experiment3
##               replicate   k   n
## Experiment1.1         1  10 765
## Experiment1.2         2   9 765
## Experiment2.1         1  41 765
## Experiment2.2         2  38 765
## Experiment3.1         1 104 765
## Experiment3.2         2  96 765</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compare results of two methods</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(comp, <span class="dt">aggregate =</span> <span class="ot">FALSE</span>)
<span class="kw">title</span>(<span class="st">"GLM"</span>)
<span class="kw">plot</span>(comp_ratio, <span class="dt">aggregate =</span> <span class="ot">FALSE</span>)
<span class="kw">title</span>(<span class="st">"Ratio"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-22-3.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
</div>
<div id="comparison-of-frameworks" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#comparison-of-frameworks" class="anchor"> </a></body></html>Comparison of frameworks</h2>
<p>Two approaches presented above were compared in a simulation approach over 150.000 simulated array dPCR experiments. Each simulation contained six reactions. Three of them had roughly the same amount of molecules per plate and other three had experiments with 10 to 50 molecules more. Experiments were compared using GLM and MT frameworks.</p>
<p><img src="overview_files/figure-html/unnamed-chunk-23-1.png" width="576"></p>
<p>On average, 2.03 and 1.98 reactions were assessed to a wrong group by respectively GLM and MT.</p>
<p>A single GLM comparison took roughly 183 times longer than MT (on average 1.10 seconds versus 0.006 seconds on the Intel i7-2600 processor). The difference grows with the number of experiments and number of partitions (data not shown).</p>
</div>
<div id="probability-coverage-of-confidence-intervals" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#probability-coverage-of-confidence-intervals" class="anchor"> </a></body></html>Probability coverage of confidence intervals</h2>
<p>Average coverage probability is the proportion of the time that the interval contains the true value of <span class="math inline">\(\lambda\)</span>.</p>
<p>In the example below, we simulated 1 droplet dPCR experiments (2 droplets each) for each level of <span class="math inline">\(\lambda\)</span> (1.2 experiments total). We computed average probability coverage of CI obtained by three methods: Dube&rsquo;s<span class="citation">(Dube, Qin, and Ramakrishnan 2008)</span>, Bhat&rsquo;s<span class="citation">(Bhat et al. 2009)</span> and by MT (<span class="math inline">\(\alpha = 0.95\)</span>).</p>
<p>To assess simultaneous coverage probability, we randomly divided experiments into 2000 groups (500 experiments each) for each possible value of <span class="math inline">\(\lambda\)</span>. We counted frequency of groups in which all confidence intervals contain the true value of <span class="math inline">\(\lambda\)</span>.</p>
<p><img src="overview_files/figure-html/unnamed-chunk-24-1.png" width="576"></p>
<p>The dashed black line marks 0.95 border.</p>
<!-- html table generated in R 3.3.1 by xtable 1.8-2 package -->
<!-- Tue Nov  1 10:41:16 2016 -->
<table border="1" class="table"><tr><th>
Method name
</th>
<th>
Type of coverage
</th>
<th>
Value
</th>
</tr><tr><td>
Adjusted
</td>
<td>
Average probability coverage
</td>
<td align="right">
1.00
</td>
</tr><tr><td>
Bhat
</td>
<td>
Average probability coverage
</td>
<td align="right">
0.69
</td>
</tr><tr><td>
Dube
</td>
<td>
Average probability coverage
</td>
<td align="right">
0.95
</td>
</tr><tr><td>
Adjusted
</td>
<td>
Simultaneous probability coverage
</td>
<td align="right">
0.95
</td>
</tr><tr><td>
Bhat
</td>
<td>
Simultaneous probability coverage
</td>
<td align="right">
0.00
</td>
</tr><tr><td>
Dube
</td>
<td>
Simultaneous probability coverage
</td>
<td align="right">
0.01
</td>
</tr></table></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor"><html><body><a href="#references" class="anchor"> </a></body></html>References</h1>
<div id="refs" class="references">
<div id="ref-benjamini_1995">
<p>Benjamini, Yoav, and Yosef Hochberg. 1995. &ldquo;Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing.&rdquo; <em>Journal of the Royal Statistical Society. Series B (Methodological)</em> 57 (1). Blackwell Publishing for the Royal Statistical Society: 289&ndash;300.</p>
</div>
<div id="ref-bhat_single_2009">
<p>Bhat, Somanath, Jan Herrmann, Paul Armishaw, Philippe Corbisier, and Kerry R Emslie. 2009. &ldquo;Single Molecule Detection in Nanofluidic Digital Array Enables Accurate Measurement of DNA Copy Number.&rdquo; <em>Analytical and Bioanalytical Chemistry</em> 394 (2): 457&ndash;67. doi:<a href="https://doi.org/10.1007/s00216-009-2729-5">10.1007/s00216-009-2729-5</a>.</p>
</div>
<div id="ref-brown_2001">
<p>Brown, Lawrence D., T. Tony Cai, and Anirban DasGupta. 2001. &ldquo;Interval Estimation for a Binomial Proportion.&rdquo; <em>Statist. Sci.</em> 16 (2). The Institute of Mathematical Statistics: 101&ndash;33. doi:<a href="https://doi.org/10.1214/ss/1009213286">10.1214/ss/1009213286</a>.</p>
</div>
<div id="ref-dube_mathematical_2008">
<p>Dube, Simant, Jian Qin, and Ramesh Ramakrishnan. 2008. &ldquo;Mathematical Analysis of Copy Number Variation in a DNA Sample Using Digital PCR on a Nanofluidic Device.&rdquo; <em>PloS One</em> 3 (8): e2876. doi:<a href="https://doi.org/10.1371/journal.pone.0002876">10.1371/journal.pone.0002876</a>.</p>
</div>
<div id="ref-fay_2010">
<p>Fay, Michael. 2010. &ldquo;Two-Sided Exact Tests and Matching Confidence Intervals for Discrete Data.&rdquo; <em>Proceedings of the National Academy of Sciences of the United States of America</em> 2 (1): 53&ndash;58.</p>
</div>
<div id="ref-huggett_digital_2013">
<p>Huggett, Jim F, Carole A Foy, Vladimir Benes, Kerry Emslie, Jeremy A Garson, Ross Haynes, Jan Hellemans, et al. 2013. &ldquo;The Digital MIQE Guidelines: Minimum Information for Publication of Quantitative Digital PCR Experiments.&rdquo; <em>Clinical Chemistry</em> 59 (6): 892&ndash;902. doi:<a href="https://doi.org/10.1373/clinchem.2013.206375">10.1373/clinchem.2013.206375</a>.</p>
</div>
<div id="ref-huggett_considerations_2014">
<p>Huggett, Jim F., Simon Cowen, and Carole A. Foy. 2014. &ldquo;Considerations for Digital PCR as an Accurate Molecular Diagnostic Tool.&rdquo; <em>Clinical Chemistry</em>, October, clinchem.2014.221366. doi:<a href="https://doi.org/10.1373/clinchem.2014.221366">10.1373/clinchem.2014.221366</a>.</p>
</div>
<div id="ref-pabinger_survey_2014">
<p>Pabinger, Stephan, Stefan R&ouml;diger, Albert Kriegner, Klemens Vierlinger, and Andreas Weinh&auml;usel. 2014. &ldquo;A Survey of Tools for the Analysis of Quantitative PCR (QPCR) Data.&rdquo; <em>Biomolecular Detection and Quantification</em> 1 (1): 23&ndash;33. doi:<a href="https://doi.org/10.1016/j.bdq.2014.08.002">10.1016/j.bdq.2014.08.002</a>.</p>
</div>
<div id="ref-ritz_qpcr_2008">
<p>Ritz, Christian, and Andrej-Nikolai Spiess. 2008. &ldquo;QpcR: An R Package for Sigmoidal Model Selection in Quantitative Real-Time Polymerase Chain Reaction Analysis.&rdquo; <em>Bioinformatics</em> 24 (13): 1549&ndash;51. doi:<a href="https://doi.org/10.1093/bioinformatics/btn227">10.1093/bioinformatics/btn227</a>.</p>
</div>
<div id="ref-roediger2015chippcr">
<p>R&ouml;diger, Stefan, Micha&#322; Burdukiewicz, and Peter Schierack. 2015. &ldquo;ChipPCR: An R Package to Pre-Process Raw Data of Amplification Curves.&rdquo; <em>Bioinformatics</em> 31 (17): 2900&ndash;2902. doi:<a href="https://doi.org/10.1093/bioinformatics/btv205">10.1093/bioinformatics/btv205</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#dpcr-object"><code>dpcr</code> object</a><ul class="nav nav-pills nav-stacked"><li><a href="#dpcr-objects-management-bind_dpcr-extract_run"><code>dpcr</code> objects management (<code>bind_dpcr</code>, <code>extract_run</code>)</a></li>
      <li><a href="#data-slot"><em>.Data</em> slot</a></li>
      <li><a href="#type-slot"><em>type</em> slot</a></li>
      </ul></li>
      <li><a href="#dpcr-workflow">dpcR workflow</a><ul class="nav nav-pills nav-stacked"><li><a href="#read-data">Read data</a></li>
      <li><a href="#summary-method">Summary method</a></li>
      <li><a href="#show-method">Show method</a></li>
      </ul></li>
      <li><a href="#adpcr-class"><code>adpcr</code> class</a><ul class="nav nav-pills nav-stacked"><li><a href="#array-visualisation">Array visualisation</a></li>
      <li><a href="#array-testing">Array testing</a></li>
      </ul></li>
      <li><a href="#qdpcr-class"><code>qdpcr</code> class</a></li>
      <li><a href="#comparison-of-the-experiments">Comparison of the experiments</a><ul class="nav nav-pills nav-stacked"><li><a href="#glm">GLM</a></li>
      <li><a href="#multiple-tests">Multiple tests</a></li>
      <li><a href="#comparison-of-frameworks">Comparison of frameworks</a></li>
      <li><a href="#probability-coverage-of-confidence-intervals">Probability coverage of confidence intervals</a></li>
      </ul></li>
      <li><a href="#references">References</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michal Burdukiewicz, Stefan Roediger, Bart Jacobs.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
