<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>dpcr_density. dpcR 0.2</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="
Michal Burdukiewicz, Stefan Roediger.
">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">dpcR 0.2</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>Calculate Density of Single dPCR Run</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>dpcr_density(k, n, average&nbsp;=&nbsp;FALSE, methods&nbsp;=&nbsp;"wilson", conf.level&nbsp;=&nbsp;0.95, plot&nbsp;=&nbsp;TRUE, bars&nbsp;=&nbsp;FALSE, ...)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>k</dt>
      <dd>Total number of positive molecules.</dd>
      <dt>n</dt>
      <dd>Total number of partitions.</dd>
      <dt>average</dt>
      <dd>If <code>TRUE</code>, calculates density of the average number of
molecules per partition. If <code>FALSE</code>, instead performs calculations for
the total number of positive molecules.</dd>
      <dt>methods</dt>
      <dd>Method for calculating the confidence interval.
Possible values are: <code>"wilson"</code>, <code>"agresti-coull"</code>,
<code>"exact"</code>, <code>"prop.test"</code>, <code>"profile"</code>, <code>"lrt"</code>,
<code>"asymptotic"</code>, <code>"bayes"</code>, <code>"cloglog"</code>, <code>"logit"</code>,
<code>"probit"</code>. Default value is <code>"wilson"</code>. See Details.</dd>
      <dt>conf.level</dt>
      <dd>The level of confidence to be used in the confidence
interval. Values from 0 to 1 and -1 to 0 are acceptable.</dd>
      <dt>plot</dt>
      <dd>If <code>TRUE</code>, plots density plot.</dd>
      <dt>bars</dt>
      <dd>plot on density plot bars for discrete values of lambda.</dd>
      <dt>...</dt>
      <dd>Additional arguments send to <code>plot</code> function.</dd>
    </dl>
    
    <div class="Value">
      <h2>Value</h2>

      <p><dl>
A data frame with one row containing bounds of the confidence
intervals and a name of the method used to calculate them.
</dl></p>
  
    </div>

    <div class="Description">
      <h2>Description</h2>

      <p>Calculates and plots the density of the number of positive
molecules or the average number of molecules per partition. Can be used for
both array digital PCR and droplet digital PCR.</p>
  
    </div>

    <div class="References">
      <h2>References</h2>

      <p>Brown, Lawrence D., T. Tony Cai, and Anirban DasGupta.
<em>Confidence Intervals for a Binomial Proportion and Asymptotic
Expansions.</em> The Annals of Statistics 30, no. 1 (February 2002): 160--201.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'># Calculate the average number of molecules per partition and show the area
# of the confidence interval (left plot) and the area within the
# confidence interval
par(mfrow = c(1,2))
dpcr_density(k = 25, n = 55, average = TRUE, methods = &quot;wilson&quot;,
	     conf.level = 0.95)
</div>
<div class='output'>  method  k  n    lambda    lower     upper
1 wilson 25 55 0.6061358 0.400855 0.8789302
</div>
<div class='input'>dpcr_density(k = 25, n = 55, average = TRUE, methods = &quot;wilson&quot;,
	     conf.level = -0.95)
</div>
<p><img src='dpcr_density-4.png' alt='' width='540' height='400' /></p>
<div class='output'>  method  k  n    lambda     lower    upper
1 wilson 25 55 0.6061358 0.8789302 0.400855
</div>
<div class='input'>par(mfrow = c(1,1))

# By setting average to FALSE the total number of positive molecules is
# calculated
dpcr_density(k = 25, n = 55, average = FALSE, methods = &quot;wilson&quot;,
	     conf.level = 0.95)
</div>
<p><img src='dpcr_density-7.png' alt='' width='540' height='400' /></p>
<div class='output'>  method  k  n mean   lower    upper
1 wilson 25 55   25 18.1639 32.16252
</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>dpcr_density</li>
    </ul>
    <ul>
      <li>dplot</li><li>hplot</li>
    </ul> -->
      
    <h2>See also</h2>
    
Computation of confidence intervals: <a href='http://www.inside-r.org/packages/cran/binom/docs/binom.confint'>binom.confint</a>,

The browser-based graphical user interface for this function: <a href='dpcr_density_gui.html'>dpcr_density_gui</a>.

    
    <h2>Author</h2>
    
Michal Burdukiewicz, Stefan Roediger.

    
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>