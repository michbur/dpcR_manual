<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>plot_panel. dpcR 0.2</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="
Michal Burdukiewicz, Stefan Roediger.
">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">dpcR 0.2</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>Plot Panel</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>plot_panel(input, use_breaks&nbsp;=&nbsp;TRUE, col&nbsp;=&nbsp;"red", legend&nbsp;=&nbsp;TRUE, half&nbsp;=&nbsp;"none", plot&nbsp;=&nbsp;TRUE, ...)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>input</dt>
      <dd>object of the <code>adpcr</code> class.</dd>
      <dt>use_breaks</dt>
      <dd>if <code>TRUE</code>, input is cutted into intervals using the
<code>breaks</code> slot. If <code>FALSE</code>, the <code>integer</code> class of the input is
preserved. Ignored if data has <code>"np"</code> type (see possible types of
<code>adpcr</code> objects).</dd>
      <dt>col</dt>
      <dd>A single color or vector of colors for each level of input.</dd>
      <dt>legend</dt>
      <dd>If <code>TRUE</code>, a built-in legend is added to the plot.</dd>
      <dt>half</dt>
      <dd>If <code>left</code> or <code>right</code>, every well is represented only
by the adequate half of the rectangle.</dd>
      <dt>plot</dt>
      <dd><code>"logical"</code>, if <code>FALSE</code>, only plot data is returned
invisibly.</dd>
      <dt>...</dt>
      <dd>Arguments to be passed to <code>plot</code> function.</dd>
    </dl>
    
    <div class="Value">
      <h2>Value</h2>

      <p><dl>
Invisibly returns two sets of coordinates of each microfluidic well
as per <code><a href='calc_coordinates.html'>calc_coordinates</a></code>:
<code>coords</code> is a list of coordinates suitable for usage with functions from
<code><a href='http://www.inside-r.org/r-doc/graphics/graphics-package'>graphics</a></code> package. The second element is a data frame of coordinates
useful for users utilizing ggplot2 package.
</dl></p>
  
    </div>

    <div class="Description">
      <h2>Description</h2>

      <p>The <code>plot_panel</code> function takes objects of the class
<code>adpcr</code> to enable customizable graphical representations
of a chamber-based digital PCR experiments (e.g., Digital Array (R) IFCs
(integrated fluidic circuits) of the BioMark (R) and EP1 (R)).</p>
  
    </div>

    <div class="Details">
      <h2>Details</h2>

      <p>Currently, only objects containing <code>tnp</code> data can be plotted as
a whole. For the any other type of the <code>adpcr</code> data, only just one column
of data (one panel) can be plotted at the same time (see Examples how easily
plot multipanel objects). Moreover the object must contain fluorescence
intensities or exact number of molecules or
the positive hits derived from the Cq values for each well. The Cq values
can be obtained by custom made functions (see example in
<code><a href='dpcr_density.html'>dpcr_density</a></code>)) or the yet to implement "qpcr_analyser function
from the dpcR package.</p>
  
      <p>If the <code>col</code> argument has length one, a color is assigned for each
interval of the input, with the brightest colors for the lowest values.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'># Create a sample dPCR experiment with 765 elements (~&gt; virtual compartments)
# of target molecule copies per compartment as integer numbers (0,1,2)
ttest &lt;- sim_adpcr(m = 400, n = 765, times = 20, pos_sums = FALSE,
                   n_panels = 1)
# Plot the dPCR experiment results with default settings
plot_panel(ttest)
</div>
<p><img src='plot_panel-2.png' alt='' width='540' height='400' /></p>
<div class='input'>
#do it without breaks
plot_panel(ttest, use_breaks = FALSE)
</div>
<p><img src='plot_panel-4.png' alt='' width='540' height='400' /></p>
<div class='input'>
# Apply a binary color code with blue as positive
slot(ttest, &quot;breaks&quot;) &lt;- c(0, 2, 4)
plot_panel(ttest, col = &quot;blue&quot;)
</div>
<p><img src='plot_panel-6.png' alt='' width='540' height='400' /></p>
<div class='input'>
# Apply a two color code for number of copies per compartment
plot_panel(ttest, col = c(&quot;blue&quot;, &quot;red&quot;))
</div>
<p><img src='plot_panel-8.png' alt='' width='540' height='400' /></p>
<div class='input'>


# supply customized breaks and compare
par(mfcol = c(2, 1))
plot_panel(ttest)
slot(ttest, &quot;breaks&quot;) &lt;- c(0, 1, 2, (max(slot(ttest, &quot;breaks&quot;)) + 1))
plot_panel(ttest)
</div>
<p><img src='plot_panel-10.png' alt='' width='540' height='400' /></p>
<div class='input'>par(mfcol = c(1, 1))

# plot few panels
ttest2 &lt;- sim_adpcr(m = 400, n = 765, times = 40, pos_sums = FALSE,
                    n_panels = 4)
par(mfcol = c(2, 2))
four_panels &lt;- lapply(1:ncol(ttest2), function(i)
       plot_panel(extract_dpcr(ttest2, i), legend = FALSE,
         main = paste(&quot;Panel&quot;, LETTERS[i], sep = &quot; &quot;)))
</div>
<p><img src='plot_panel-12.png' alt='' width='540' height='400' /></p>
<div class='input'>par(mfcol = c(1, 1))

# two different channels
plot_panel(extract_dpcr(ttest2, 1), legend = FALSE,
           half = &quot;left&quot;)
</div>
<div class='input'>par(new = TRUE)
plot_panel(extract_dpcr(ttest2, 2), col = &quot;blue&quot;,
           legend = FALSE, half = &quot;right&quot;)
</div>
<p><img src='plot_panel-15.png' alt='' width='540' height='400' /></p>
<div class='input'>
# plot two panels with every well as only the half of the rectangle
ttest3 &lt;- sim_adpcr(m = 400, n = 765, times = 40, pos_sums = FALSE,
                    n_panels = 2)
par(mfcol = c(1, 2))
two_panels &lt;- lapply(1:ncol(ttest3), function(i)
       plot_panel(extract_dpcr(ttest3, i), legend = FALSE,
         main = paste(&quot;Panel&quot;, LETTERS[i], sep = &quot; &quot;)))
</div>
<p><img src='plot_panel-17.png' alt='' width='540' height='400' /></p>
<div class='input'>par(mfcol = c(1, 1))
</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>plot_panel</li>
    </ul>
    <ul>
      <li>hplot</li>
    </ul> -->
      
    <h2>See also</h2>
    
<code><a href='extract_dpcr.html'>extract_dpcr</a></code> - extract experiments.
<code><a href='adpcr2panel.html'>adpcr2panel</a></code> - convert <code>adpcr</code> object to arrays.

    
    <h2>Author</h2>
    
Michal Burdukiewicz, Stefan Roediger.

    
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>