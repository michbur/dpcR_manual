<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate Array Digital PCR — sim_adpcr • dpcR</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">dpcR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/michbur/dpcR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate Array Digital PCR</h1>
    </div>

    
    <p>A function that simulates results of an array digital PCR.</p>
    

    <pre><span class='fu'>sim_adpcr</span>(<span class='no'>m</span>, <span class='no'>n</span>, <span class='no'>times</span>, <span class='kw'>n_panels</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>dube</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>pos_sums</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>m</dt>
      <dd>the total number of template molecules added to the plate. Must be
a positive integer.</dd>
      <dt>n</dt>
      <dd>the number of chambers per plate. Must be a positive integer.</dd>
      <dt>times</dt>
      <dd>number of repetitions (see Details).</dd>
      <dt>n_panels</dt>
      <dd>the number of panels that are simulated by the function.
Cannot have higher value than the <code>times</code> argument.</dd>
      <dt>dube</dt>
      <dd>if <code>TRUE</code>, the function is strict implementation of array
digital PCR simulation (as in Dube et al., 2008). If <code>FALSE</code>, the
function calculates only approximation of Dube&#39;s experiment. See Details and
References.</dd>
      <dt>pos_sums</dt>
      <dd>if <code>TRUE</code>, function returns only the total number of
positive (containing at least one molecule) chamber per panel. If
<code>FALSE</code>, the functions returns a vector of length equal to the number
of chambers. Each element of the vector represents the number of template
molecules in a given chamber.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If the <code>pos_sums</code> argument has value <code>FALSE</code>, the function
returns a matrix with \(n\) rows and \(n_panels\) columns. Each column
represents one plate. The type of such simulation would be <code>&quot;nm&quot;</code>. If the
<code>pos_sums</code> argument has value <code>TRUE</code>, the function returns a
matrix with one row and \(n_panels\) columns. Each column contains the
total number of positive chambers in each plate and type of simulation would
be set as <code>&quot;tnp&quot;</code>.</p>
    <p>In each case the value is an object of the <code><a href='adpcr-class.html'>adpcr</a></code> class.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The array digital PCR is performed on plates containing many microfluidic
chambers with a randomly distributed DNA template, fluorescence labels and
standard PCR reagents. After the amplification reaction, performed
independently in each chamber, the chambers with the fluorescence level
below certain threshold are treated as negative. From differences between
amplification curves of positive chambers it is possible to calculate both
total number of template molecules and their approximate number in a
single chamber.</p>
    <p>The function contains two implementations of the array digital PCR
simulation. First one was described in Dube at. al (2008). This method is
based on random distributing \(m \times times\) molecules
between \(n \times times\) chambers.  After this step, the
required number of plates is created by the random sampling of chambers
without replacement. The above method is used, when the <code>dube</code> argument
has value <code>TRUE</code>.</p>
    <p>The second method treats the total number of template molecules as random
variable with a normal distribution \(\mathcal{N}(n, 0.05n)\). The exact sum of total molecules per plate is calculated and
randomly adjusted to the value of \(m \times times\). The above
method is used, when the <code>dube</code> argument has value <code>FALSE</code>. This
implementation is much faster than previous one, especially for big
simulations. The higher the value of the argument <code>times</code>, the
simulation result is closer to theoretical calculations.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Dube S, Qin J, Ramakrishnan R, <em>Mathematical Analysis of
Copy Number Variation in a DNA Sample Using Digital PCR on a Nanofluidic
Device</em>.  PLoS ONE 3(8), 2008.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='sim_dpcr.html'>sim_dpcr</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples">
      <a class="anchor" href="#examples"></a>
      Examples
    </h2>
    <pre class="examples"><div class='input'>
<span class='co'># Simulation of a digital PCR experiment with a chamber based technology.</span>
<span class='co'># The parameter pos_sums was altered to change how the total number of positive </span>
<span class='co'># chamber per panel are returned. An alteration of the parameter has an impact </span>
<span class='co'># in the system performance.</span>
<span class='no'>adpcr_big</span> <span class='kw'>&lt;-</span> <span class='fu'>sim_adpcr</span>(<span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>40</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>pos_sums</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>n_panels</span> <span class='kw'>=</span> <span class='fl'>1000</span>)</div><div class='output'><strong class='text-info'>The assumed volume of partitions in each run is equal to 1.</strong></div><div class='output'><strong class='text-info'>The assumed volume uncertainty in each run is equal to 0.</strong></div><div class='input'><span class='no'>adpcr_small</span> <span class='kw'>&lt;-</span> <span class='fu'>sim_adpcr</span>(<span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>40</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>pos_sums</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>n_panels</span> <span class='kw'>=</span> <span class='fl'>1000</span>)</div><div class='output'><strong class='text-info'>The assumed volume of partitions in each run is equal to 1.</strong></div><div class='output'><strong class='text-info'>The assumed volume uncertainty in each run is equal to 0.</strong></div><div class='input'><span class='co'># with pos_sums = TRUE, output allocates less memory</span>
<span class='fu'>object.size</span>(<span class='no'>adpcr_big</span>)</div><div class='output co'>#&gt; 536760 bytes
#&gt; </div><div class='input'><span class='fu'>object.size</span>(<span class='no'>adpcr_small</span>)</div><div class='output co'>#&gt; 171904 bytes
#&gt; </div><div class='input'>
<span class='co'># Mini version of Dube et al. 2008 experiment, full requires replic &lt;- 70000</span>
<span class='co'># The number of replicates was reduced by a factor of 100 to lower the computation time.</span>
<span class='no'>replic</span> <span class='kw'>&lt;-</span> <span class='fl'>700</span>
<span class='no'>dube</span> <span class='kw'>&lt;-</span> <span class='fu'>sim_adpcr</span>(<span class='fl'>400</span>, <span class='fl'>765</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='no'>replic</span>, <span class='kw'>dube</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
    <span class='kw'>pos_sums</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>n_panels</span> <span class='kw'>=</span> <span class='no'>replic</span>)</div><div class='output'><strong class='text-info'>The assumed volume of partitions in each run is equal to 1.</strong></div><div class='output'><strong class='text-info'>The assumed volume uncertainty in each run is equal to 0.</strong></div><div class='input'><span class='fu'>mean</span>(<span class='no'>dube</span>) <span class='co'># 311.5616</span></div><div class='output co'>#&gt; [1] 311.1414
#&gt; </div><div class='input'><span class='fu'>sd</span>(<span class='no'>dube</span>) <span class='co'># 13.64159</span></div><div class='output co'>#&gt; [1] 13.85512
#&gt; </div><div class='input'>
<span class='co'># Create a barplot from the simulated data similar to Dube et al. 2008</span>
<span class='no'>bp</span> <span class='kw'>&lt;-</span> <span class='fu'>barplot</span>(<span class='fu'>table</span>(<span class='fu'>factor</span>(<span class='no'>dube</span>, <span class='kw'>levels</span> <span class='kw'>=</span> <span class='fu'>min</span>(<span class='no'>dube</span>):<span class='fu'>max</span>(<span class='no'>dube</span>))),
              <span class='kw'>space</span> <span class='kw'>=</span> <span class='fl'>0</span>)</div><div class='input'><span class='fu'>lines</span>(<span class='no'>bp</span>, <span class='fu'>dnorm</span>(<span class='fu'>min</span>(<span class='no'>dube</span>):<span class='fu'>max</span>(<span class='no'>dube</span>), <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>311.5</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>13.59</span>)*<span class='no'>replic</span>,
      <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"green"</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>3</span>)</div><img src='sim_adpcr-20.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'># Exact Dube's method is a bit slower than other one, but more accurate</span>
<span class='fu'>system.time</span>(<span class='no'>dub</span> <span class='kw'>&lt;-</span> <span class='fu'>sim_adpcr</span>(<span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>400</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>765</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>n_panels</span> <span class='kw'>=</span> <span class='fl'>500</span>,
  <span class='kw'>pos_sums</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))</div><div class='output'><strong class='text-info'>The assumed volume of partitions in each run is equal to 1.</strong></div><div class='output'><strong class='text-info'>The assumed volume uncertainty in each run is equal to 0.</strong></div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.452   0.000   0.451 
#&gt; </div><div class='input'><span class='fu'>system.time</span>(<span class='no'>mul</span> <span class='kw'>&lt;-</span> <span class='fu'>sim_adpcr</span>(<span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>400</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>765</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>n_panels</span> <span class='kw'>=</span> <span class='fl'>500</span>,
  <span class='kw'>pos_sums</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>))</div><div class='output'><strong class='text-info'>The assumed volume of partitions in each run is equal to 1.</strong></div><div class='output'><strong class='text-info'>The assumed volume uncertainty in each run is equal to 0.</strong></div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.388   0.000   0.386 
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Michal Burdukiewicz.

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Michal Burdukiewicz, Stefan Roediger, Bart Jacobs.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
