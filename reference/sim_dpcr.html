<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate Droplet Digital PCR — sim_dpcr • dpcR</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">dpcR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/michbur/dpcR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate Droplet Digital PCR</h1>
    </div>

    
    <p>A function that simulates results of a droplet digital PCR.</p>
    

    <pre><span class='fu'>sim_dpcr</span>(<span class='no'>m</span>, <span class='no'>n</span>, <span class='no'>times</span>, <span class='kw'>n_exp</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>dube</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>pos_sums</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>fluo</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>m</dt>
      <dd>the total number of template molecules used in the expertiment. Must be
a positive integer.</dd>
      <dt>n</dt>
      <dd>the number of droplets per experiment. Must be a positive integer.</dd>
      <dt>times</dt>
      <dd>number of repetitions (see Details).</dd>
      <dt>n_exp</dt>
      <dd>the number of experiments that are simulated by the function.
Cannot have higher value than the <code>times</code> argument.</dd>
      <dt>dube</dt>
      <dd>if <code>TRUE</code>, the function is strict implementation of digital
PCR simulation (as in Dube et al., 2008). If <code>FALSE</code>, the function
calculates only approximation of Dube&#39;s experiment. See Details and
References.</dd>
      <dt>pos_sums</dt>
      <dd>if <code>TRUE</code>, function returns only the total number of
positive (containing at least one molecule) chamber per panel. If
<code>FALSE</code>, the functions returns a vector of length equal to the number
of chambers. Each element of the vector represents the number of template
molecules in a given chamber.</dd>
      <dt>fluo</dt>
      <dd>if <code>NULL</code>, the function calculates number of molecules per
well or total number of positive droplets. If list of two, the first
argument defines smoothness of the fluorescence curve and second space
between two consecutive measured droplets. Space must be a vector containing
positive integers of the length <code>n</code> or 1.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If the <code>pos_sums</code> argument has value <code>FALSE</code>, the function
returns matrix with \(n\) rows and \(n_panels\) columns. Each column
represents one plate. The type of such simulation would be <code>&quot;nm&quot;</code>. If the
<code>pos_sums</code> argument has value <code>TRUE</code>, the function return matrix
with one row and \(n_panels\) columns. Each column contains the total
number of positive chambers in each plate and type of simulation would be
set as <code>&quot;tnp&quot;</code>.</p>
    <p>In each case the value is an object of the <code><a href='dpcr-class.html'>dpcr</a></code> class.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function contains two
implementations of the array digital PCR simulation. First one was described
in Dube at. al (2008). This method is based on random distributing \(m
\times times\) molecules between \(n \times times\)
chambers.  After this step, the required number of plates is created by the
random sampling of chambers without replacement. The above method is used,
when the <code>dube</code> argument has value <code>TRUE</code>.</p>
    <p>The higher the value of the argument <code>times</code>, the simulation result is
closer to theoretical calculations.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Although Dube&#39;s simulation of digital PCR was developed for array
digital PCR, it&#39;s also viable for simulating droplet-based methods.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='sim_adpcr.html'>sim_adpcr</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples">
      <a class="anchor" href="#examples"></a>
      Examples
    </h2>
    <pre class="examples"><div class='input'>
<span class='co'>#simulate fluorescence data</span>
<span class='no'>tmp_VIC</span> <span class='kw'>&lt;-</span> <span class='fu'>sim_dpcr</span>(<span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>7</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>fluo</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='fl'>0.1</span>, <span class='fl'>0</span>))
<span class='no'>tmp_FAM</span> <span class='kw'>&lt;-</span> <span class='fu'>sim_dpcr</span>(<span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>15</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>fluo</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='fl'>0.1</span>, <span class='fl'>0</span>))
<span class='fu'>par</span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>2</span>,<span class='fl'>1</span>))
<span class='fu'>plot</span>(<span class='no'>tmp_VIC</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"green"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>)
<span class='fu'>plot</span>(<span class='no'>tmp_FAM</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"blue"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>)</div><img src='sim_dpcr-2.png' alt='' width='540' height='400' /><div class='input'><span class='fu'><a href='summary-methods.html'>summary</a></span>(<span class='no'>tmp_FAM</span>)</div><div class='output co'>#&gt; 
#&gt; Number of positive partitions: 11 
#&gt; Total number of partitions:    20 
#&gt; 
#&gt; Number of runs:        1 
#&gt; Number of experiments: 1 
#&gt; 
#&gt;   experiment replicate   assay method    lambda lambda.low lambda.up        m
#&gt;  Experiment1         1 Unknown   dube 0.7985077  0.4034189  1.461157 15.97015
#&gt;  Experiment1         1 Unknown   bhat 0.7985077  0.5513011  1.045714 15.97015
#&gt;      m.low     m.up         c     c.low     c.up  k  n
#&gt;   8.068377 29.22314 0.7985077 0.4034189 1.461157 11 20
#&gt;  11.026022 20.91429 0.7985077 0.5513011 1.045714 11 20
#&gt; </div><div class='input'>
<span class='fu'><a href='summary-methods.html'>summary</a></span>(<span class='fu'>sim_dpcr</span>(<span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>7</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>n_exp</span> <span class='kw'>=</span> <span class='fl'>5</span>))</div><div class='output'><strong class='text-info'>The assumed volume of partitions in each run is equal to 1.</strong></div><div class='output'><strong class='text-info'>The assumed volume uncertainty in each run is equal to 0.</strong></div><div class='output co'>#&gt; 
#&gt; Number of positive partitions: 6, 7, 6, 6, ... 
#&gt; Total number of partitions:    20, 20, 20, 20, ... 
#&gt; 
#&gt; Number of runs:        5 
#&gt; Number of experiments: 1 
#&gt; 
#&gt;   experiment replicate   assay method    lambda lambda.low lambda.up        m
#&gt;  Experiment1         1 Unknown   dube 0.3566749 0.10443145 0.6948217 7.133499
#&gt;  Experiment1         1 Unknown   bhat 0.3566749 0.21028993 0.5030600 7.133499
#&gt;  Experiment1         2 Unknown   dube 0.4307829 0.15194293 0.8187950 8.615658
#&gt;  Experiment1         2 Unknown   bhat 0.4307829 0.26670039 0.5948654 8.615658
#&gt;  Experiment1         3 Unknown   dube 0.3566749 0.10443145 0.6948217 7.133499
#&gt;  Experiment1         3 Unknown   bhat 0.3566749 0.21028993 0.5030600 7.133499
#&gt;  Experiment1         4 Unknown   dube 0.3566749 0.10443145 0.6948217 7.133499
#&gt;  Experiment1         4 Unknown   bhat 0.3566749 0.21028993 0.5030600 7.133499
#&gt;  Experiment1         5 Unknown   dube 0.2231436 0.02500554 0.4704910 4.462871
#&gt;  Experiment1         5 Unknown   bhat 0.2231436 0.11134015 0.3349470 4.462871
#&gt;      m.low      m.up         c      c.low      c.up k  n
#&gt;  2.0886291 13.896433 0.3566749 0.10443145 0.6948217 6 20
#&gt;  4.2057987 10.061199 0.3566749 0.21028993 0.5030600 6 20
#&gt;  3.0388586 16.375900 0.4307829 0.15194293 0.8187950 7 20
#&gt;  5.3340077 11.897309 0.4307829 0.26670039 0.5948654 7 20
#&gt;  2.0886291 13.896433 0.3566749 0.10443145 0.6948217 6 20
#&gt;  4.2057987 10.061199 0.3566749 0.21028993 0.5030600 6 20
#&gt;  2.0886291 13.896433 0.3566749 0.10443145 0.6948217 6 20
#&gt;  4.2057987 10.061199 0.3566749 0.21028993 0.5030600 6 20
#&gt;  0.5001108  9.409819 0.2231436 0.02500554 0.4704910 4 20
#&gt;  2.2268030  6.698939 0.2231436 0.11134015 0.3349470 4 20
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Michal Burdukiewicz, Stefan Roediger.

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Michal Burdukiewicz, Stefan Roediger, Bart Jacobs.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
